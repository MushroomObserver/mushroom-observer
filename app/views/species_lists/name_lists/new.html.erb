<%
  add_page_title(:name_lister_title.t)

  add_tab_set(species_list_form_name_list_tabs)
  @container = :wide

  # javascript_include "name_lister"
  # javascript_include "/name_list_data.js"  # leading slash should take it out of asset pipeline
%>

<noscript>
  <div class="container-text mt-3">
    <%= :name_lister_no_js.tp %>
  </div>
</noscript>

<table cols="3" width="100%" class="name-lister mt-3"
       data-controller="name-list"
       data-action="keypress->name-list#nl_keypress keydown->name-list#nl_keydown keyup->name-list#nl_keyup click->name-list#nl_unfocus">
  <thead>
    <tr>
      <th width="20%"><%= :name_lister_genera.t %></th>
      <th width="40%"><%= :name_lister_species.t %></th>
      <th width="40%"><%= :name_lister_names.t %></th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td align="left">
        <%= tag.div(
          "", id: "genera", class: "scroller",
          data: { name_list_target: "genera",
                  action: "click->name-list#nl_focus" }
        ) %>
      </td>
      <td align="left">
        <%= tag.div(
          "", id: "species", class: "scroller",
          data: { name_list_target: "species",
                  action: "click->name-list#nl_focus" }
        ) %>
      </td>
      <td align="left">
        <%= tag.div(
          "", id: "names", class: "scroller",
          data: { name_list_target: "names",
                  action: "click->name-list#nl_focus" }
        ) %>
      </td>
    </tr>

    <tr>
      <td colspan="3">
        <div id="word">&nbsp;</div>
        <%= render(partial: "species_lists/name_lists/form") %>
      </td>
    </tr>
  </tbody>
</table>

<div id="log mt-3"></div>

<%# inject_javascript_at_end %(
  nl_initialize_names();
  nl_draw("g", NL_GENERA);
  nl_draw("n", NL_NAMES);
  jQuery(document).keypress(nl_keypress);
  jQuery(document).keydown(nl_keydown);
  jQuery(document).keyup(nl_keyup);
  jQuery(document).click(nl_unfocus);
  nc("g", 0); // click on first genus
) %>

<div class="container-text mt-3">
  <div class="help-note"><%= :name_lister_help.tp %></div>
</div>
