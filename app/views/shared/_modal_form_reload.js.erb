<%
# What to do if a form submit doesn't succeed
# Takes locals: { identifier:, form:, form_locals: }
form_locals ||= {}
form_locals = form_locals.merge({ format: :turbo_stream })
%>

// replace the flash notices in the modal
$("#modal_flash").html("<%= j flash_notices_html %>");

// re-render the form in the modal
$("#<%= identifier %>_form").replaceWith('<%= j render(
  partial: form,
  locals: { local: false }.merge(form_locals)
) %>')
