<% #bs4
  if limit && comments
    and_more = comments.length - limit
    comments = comments[0..limit-1]
  end
%>

<%= turbo_stream_from(object, :comments) %>
<%# NOTE: #comments is the inner list-group, not the whole panel %>

<%= render(Components::Panel.new(
  inner_id: "comments_for_object",
  heading: :COMMENTS.t,
  heading_links: (controls ? new_comment_link(object, btn_class: nil,
                                               icon: true) : nil),
  footer: (controls && limit && and_more > 0 ?
           link_to(:show_comments_and_more.t(num: and_more),
                   comments_path(target: object.id, type: object.class.name),
                   class: "float-right") : nil)
)) do %>
  <div id="comments" class="list-group list-group-flush comments">
    <% unless comments.empty? %>
      <% comments.each do |comment| %>
        <%= render(partial: "comments/comment", object: comment,
                   locals: { controls: }) %>
      <% end %>
    <% end %>
    <%= tag.div(:show_comments_no_comments_yet.t,
                class: "list-group-item none-yet") %>
  </div>
<% end %>
