<%# locals: (field_columns: [], search_type: nil, local: true) -%>

<%= form_with(model: @filter, url: { action: :create }) do |f| %>

  <%= tag.div(class: "row") do %>
    <% field_columns.each do |panels| %>

      <%= tag.div(class: "col-xs-12 col-md-6") do %>
        <% panels.each do |heading, fields| %>

          <%= panel_block(heading: :"search_term_group_#{heading}".l) do %>
            <% fields.each do |field| %>

              <% if field.is_a?(Array) %>
                <%= tag.div(class: "row") do %>
                  <% field.each do |subfield| %>
                    <%= tag.div(class: filter_columns) do %>
                      <%= filter_field(form: f, field: subfield,
                                       type: search_type) %>
                    <% end %>
                  <% end %>
                <% end %>
              <% else %>
                <%= filter_field(form: f, field: field, type: search_type) %>
              <% end %>

            <% end %>
          <% end %>

        <% end %>
      <% end %>

    <% end %>
  <% end %>

  <%= tag.div(class: "text-center") do %>
    <%= submit_button(form: f, button: :SEARCH.l,
                      class: "d-inline-block mx-3") %>

    <%= submit_button(form: f, button: :CLEAR.l,
                      class: "d-inline-block mx-3") %>
  <% end %>

<% end %>
