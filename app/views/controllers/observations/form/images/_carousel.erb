<%=
# TODO: make this a component
# Optional args:
#   images: @good_images
#   top_img: (defaults to first), (carousel)title:, (image_edit)links:
#
# Note: uses concat(x) instead of [x,y].safe_join because of conditionals

images ||= nil #
top_img ||= images.first #
html_id = "observation_upload_images_carousel"

# concat(carousel_heading(title, links)) if thumbnails
# printing the carousel even if empty
tag.div(class: "carousel slide edit-carousel", id: html_id,
        data: { ride: "false", interval: "false" }) do
  tag.div(class: "carousel-inner bg-light", role: "listbox",
          id: "added_images_container", # this is where JS appends
          data: { obs_form_images_target: "addedImages" }) do
    images&.each do |image|
      active = image == top_img ? "active" : ""
      concat(render(partial: "observations/form/images/carousel_item",
                    locals: { f:, image:, active:, upload: false }))
    end
    concat(tag.div(class: "carousel-control-wrap") do
      concat(carousel_controls(html_id))
      concat(tag.ol(class: "carousel-indicators") do
        images&.each_with_index do |image, index|
          active = image == top_img ? "active" : ""
          tag.li("", class: class_names("carousel-indicator", active),
                     data: { target: "##{html_id}", slide_to: index.to_s })
        end
      end)
    end)
  end
end
# end
%>
