<%
case action_name
when "new", "create"
  url_params = { action: :create, id: @observation.id,
                 external_site_id: @site.id }
  button = :ADD.t
when "edit", "update"
  url_params = { action: :update, id: @external_link.id }
  url_params = url_params.merge({ back: @back }) if @back.present?
  button = :UPDATE.t
end
form_args = {
  model: @external_link, url: url_params, id: "external_link_form"
}
if local_assigns[:local] == true
  form_args = form_args.merge({ local: true })
else
  form_args = form_args.deep_merge({ data: { turbo: true } })
end
%>

<%= form_with(**form_args) do |f| %>

  <%= text_field_with_label(
      form: f, field: :url, size: 40, label: :URL.l, class: "w-100",
      between: :required,
      append: :show_observation_add_link_dialog.t(site: @site.name)
    ) %>
  <%= f.hidden_field(:user_id, value: @user.id) %>
  <%= f.hidden_field(:observation_id, value: @observation.id) %>
  <%= f.hidden_field(:external_site_id, value: @site.id) %>

  <%= submit_button(form: f, button: button, center: true) %>

<% end %>
