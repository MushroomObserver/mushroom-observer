<%
fields_1 = {
  # date
  date: [:date, :parse_date_range],
  created: [:created_at, :parse_date_range],
  modified: [:updated_at, :parse_date_range],

  # names
  has_name: [:with_name, :parse_boolean],
  name: [:names, :parse_list_of_names],
  confidence: [:confidence, :parse_confidence],
  exclude_consensus: [:exclude_consensus, :parse_boolean], # of_look_alikes
  include_subtaxa: [:include_subtaxa, :parse_boolean],
  include_synonyms: [:include_synonyms, :parse_boolean],
  include_all_name_proposals: [:include_all_name_proposals, :parse_boolean],
  lichen: [:lichen, :parse_boolean],

  # location
  location: [:locations, :parse_list_of_locations],
  region: [:region, :parse_list_of_strings],
  has_public_lat_lng: [:with_public_lat_lng, :parse_boolean],
  is_collection_location: [:is_collection_location, :parse_boolean],
  east: [:east, :parse_longitude],
  north: [:north, :parse_latitude],
  south: [:south, :parse_latitude],
  west: [:west, :parse_longitude],

  # detail
  has_images: [:with_images, :parse_boolean],
  has_specimen: [:with_specimen, :parse_boolean],
  has_sequence: [:with_sequences, :parse_yes],
  has_notes: [:with_notes, :parse_boolean],
  has_field: [:with_notes_fields, :parse_string],
  notes: [:notes_has, :parse_string],
  has_comments: [:with_comments, :parse_yes],
  comments: [:comments_has, :parse_string],

  # associated with
  user: [:users, :parse_list_of_users],
  herbarium: [:herbaria, :parse_list_of_herbaria],
  list: [:species_lists, :parse_list_of_species_lists],
  project: [:projects, :parse_list_of_projects],
  project_lists: [:project_lists, :parse_list_of_projects],
  field_slip: [:field_slips, :parse_list_of_strings],
}.freeze
%>

<%= form_with(url: { action: :create }) do |f| %>

  <%= tag.div(class: "row") do %>
    <% [fields_1, fields_2].each do |field_groups| %>

      <%= tag.div(class: "col-xs-12 col-md-6") do %>
        <% field_groups.each do |heading, fields| %>

          <%= panel_block(heading: :"search_term_group_#{heading}".l) do %>
            <% fields.each do |field| %>

              <% if field.is_a?(Array) %>
                <%= tag.div(class: "row") do %>
                  <% field.each do |subfield| %>
                    <%= tag.div(class: "col-xs-12 col-lg-6") do %>
                      <%= pattern_search_field(form: f, field: subfield,
                                               type: :name) %>
                    <% end %>
                  <% end %>
                <% end %>
              <% else %>
                <%= pattern_search_field(form: f, field: field, type: :name) %>
              <% end %>

            <% end %>
          <% end %>

        <% end %>
      <% end %>

    <% end %>
  <% end %>

  <%= submit_button(form: f, button: :SEARCH.l, center: true) %>

<% end %>
