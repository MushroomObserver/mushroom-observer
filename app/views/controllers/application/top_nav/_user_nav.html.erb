<%
logged_in_links = context_nav_links(user_logged_in_tabs(@user))
log_out_links = context_nav_links(user_log_out_tabs)
%>

<%=
tag.li(class: "dropdown d-inline-block") do
  [
    tag.a(
      class: class_names(%w[dropdown-toggle]),
      id: "user_nav_toggle", role: "button",
      data: { toggle: "dropdown" },
      aria: { haspopup: "true", expanded: "false" }
    ) do
      concat(tag.span(@user.login))
      concat(tag.span(class: "caret ml-2"))
    end,
    tag.ul(
      id: "user_drop_down", class: "dropdown-menu",
      aria: { labelledby: "user_nav_toggle" }
    ) do
      logged_in_links.compact.each do |link|
        concat(tag.li(link))
      end
      concat(tag.li("", class: "divider"))
      log_out_links.compact.each do |link|
        concat(tag.li(link))
      end
    end
  ].safe_join
end
%>
