<%
  add_page_title(:inat_import_create_title.l)
  add_context_nav(inat_import_form_new_tabs)
%>

<div>
  <%= form_with(url: inat_imports_path, method: :post) do |f| %>
    <%= f.label(:inat_username, "#{:inat_username.l}: ") %>
    <%= f.text_field(:inat_username, size: 10, class: "form-control",
                     value: User.current.inat_username) %>

    <%= render(Components::Panel.new(panel_id: "choose_observation",
                     panel_class: "name-section")) do |panel| %>
      <%= panel.with_heading { :inat_choose_observations.l } %>
      <%= panel.with_body do %>
        <%= f.label(:inat_id, "#{:inat_import_list.l}: ") %>
        <%= f.text_field(:inat_ids, size: 10, value: @inat_ids,
                         class: "form-control") %>
        <%= check_box_with_label(form: f, field: :all,
                                 class: "mt-3", label: :inat_import_all.l) %>
        <%= :inat_import_all_details_intro.tp %>
        <%= :inat_import_all_details.tp %>
      <% end %>
    <% end %>

    <%= render(Components::Panel.new(panel_id: "preview",
                     panel_class: "name-section")) do |panel| %>
      <%= panel.with_heading { :inat_import_preview.l } %>
      <%= panel.with_body do %>
        <div>
          <p>
            <%= :inat_import_expected_count.l %>:
            <%= inat_expected_import_count(@inat_import) ||
                :inat_import_tbd.l %>
          </p>
          <p>
            <%= inat_expected_imports_link(@inat_import) %>
          </p>
        </div>
      <% end %>
    <% end %>

    <%= render(Components::Panel.new) do |panel| %>
      <%= panel.with_body do %>
        <p><b><%= :inat_details_heading.l %></b></p>
        <%= :inat_details_list.t %>
      <% end %>
    <% end %>

  <%= f.submit(:SUBMIT.l, { class: "btn btn-default" }) %>
  <%= link_to(:CANCEL.l, new_observation_path, name: "cancel",
        class: "btn btn-default") %>

  <% end %>
</div>
