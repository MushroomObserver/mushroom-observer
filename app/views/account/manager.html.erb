<%
  @navbar[:title] = { title: :ACCOUNT.t, url: account_login_path }

  @title = :account_manager_title.t
%>

<div class="form-max-width">

  <%= tag.h1 @title.humanize, class: "display-1" %>

  <%= form_with url: account_manager_path do |f| %>
    <%= f.label :ids, :account_manager_ids.t %>
    <%= f.text_field :ids,
          @users.map(&:id).map(&:to_s).join(", "), size: 40,
          class: "form-control" %>
    <%= f.label :login, :account_manager_login.t %>
    <%= f.text_field :login, "", size: 40,
          class: "form-control" %>
    <%= f.label :name, :account_manager_name.t %>
    <%= f.text_field :name, "", size: 40,
          class: "form-control" %>
    <%= f.label :email, :account_manager_name.t %>
    <%= f.text_field :email, "", size: 40,
          class: "form-control" %>

    <br/>
    <%= f.submit :SUBMIT.l, class: "btn" %>
    <br/>

    <% if !@users.empty? %>
      <table class="table user_table">
        <thead class="text-nowrap"
          <tr>
            <th><%= :ID.t %></th>
            <th><%= :LOGIN_NAME.t %></th>
            <th><%= :FULL_NAME.t %></th>
            <th><%= :EMAIL_ADDRESS.t %></th>
            <th><%= :PASSWORD.t %></th>
            <th><%= :account_manager_verified.t %></th>
            <th><%= :account_manager_last_login.t %></th>
            <th><%= :account_manager_actions.t %></th>
          </tr>
        </thead>
        <tbody>
        <% for user in @users %>
          <tr>
            <td><%= user.id %></td>
            <td><%= h(user.login) %></td>
            <td><%= h(user.name) %></td>
            <td><%= f.text_field "email_#{user.id}", user.email,
                      size: 20, class: "form-control" %></td>
            <td><%= f.text_field "password_#{user.id}", "",
                      size: 20, class: "form-control" %></td>
            <td><%= if user.verified
                user.verified.web_date
              else
                f.check_box("verified_#{user.id}",
                    checked: !!user.verified)
              end %></td>
            <td><%= user.last_login ? \
                      user.last_login.web_date : "" %></td>
            <td>
              <%= link_to(:account_manager_alert.t,
                          account_create_alert_path(
                            id: user.id)) %> |
              <%= link_to(:account_manager_bonus.t,
                          users_change_user_bonuses_path(
                            id: user.id)) %>
            </td>
          </tr>
        <% end %>
        </tbody>
      </table>

      <br/>
      <%= f.submit :SUBMIT.l, class: "btn btn-primary btn-lg mx-auto" %>
      <br/>
    <% end %>
  <% end %>

</div>
