<%
  @title = :account_manager_title.t
%>

<%= form_with(url: { action: :manager }) do |form| %>

  <%= form.label(:ids, :account_manager_ids.t) %>
  <%= form.text_field(:ids, { value: @users.map(&:id).map(&:to_s).join(", "),
                              size: 40, class: "form-control" }) %>
  <%= form.label(:login,  :account_manager_login.t) %>
  <%= form.text_field(:login, { value: "", size: 40, class: "form-control" }) %>
  <%= form.label(:name, :account_manager_name.t) %>
  <%= form.text_field(:name, { value: "", size: 40, class: "form-control" }) %>
  <%= form.label(:email, :account_manager_email.t) %>
  <%= form.text_field(:email, { value: "", size: 40, class: "form-control" }) %>

  <%= form.submit(:SUBMIT.l, class: "btn btn-default") %>

  <% if !@users.empty? %>
    <style>
      table.user_table th {
        margin: 2px;
        background: #F0C;
        white-space: nowrap;
      }
      table.user_table td {
        margin: 2px 5px 2px 5px;
        padding: 0px 5px 0px 5px;
        background: #F7F;
        white-space: nowrap;
      }
    </style>

    <table class="user_table">
      <tr>
        <th><%= :ID.t %></th>
        <th><%= :LOGIN_NAME.t %></th>
        <th><%= :FULL_NAME.t %></th>
        <th><%= :EMAIL_ADDRESS.t %></th>
        <th><%= :PASSWORD.t %></th>
        <th><%= :account_manager_verified.t %></th>
        <th><%= :account_manager_last_login.t %></th>
        <th><%= :account_manager_actions.t %></th>
      </tr>
      <% @users.each do |user| %>
        <tr>
          <td><%= user.id %></td>
          <td><%= h(user.login) %></td>
          <td><%= h(user.name) %></td>
          <td><%= form.text_field("email_#{user.id}", value: user.email, size: 20) %></td>
          <td><%= form.text_field("password_#{user.id}", value: "", size: 20) %></td>
          <td><%= if user.verified
              user.verified.web_date
            else
              form.check_box("verified_#{user.id}", checked: !!user.verified)
            end %>
          <td><%= user.last_login ? user.last_login.web_date : "" %></td>
          <td>
            <%= link_to(:account_manager_alert.t, action: :create_alert,
                        id: user.id) %> |
            <%= link_to(:account_manager_bonus.t,
                        edit_user_path(user.id)) %>
          </td>
        </tr>
      <% end %>
    </table>

    <%= form.submit(:SUBMIT.l, class: "btn btn-default") %>

  <% end %>
<% end %>
