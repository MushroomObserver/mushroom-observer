<!--[form:observation]-->
<%= form_with(model: @observation,
              url: add_query_param(action: action, id: @observation,
                                   approved_name: @what,
                                   approved_where: @place_name),
              method: method,
              multipart: true,
              name: "observation_form") do |f|%>

  <%= f.submit(button_name, class: "btn btn-default center-block mt-3") %>

  <!-- WHEN -->
  <div class="container-text">
    <%= f.label(:when_li, :WHEN.t + ":") %>
    <div class="form-group form-inline">
      <%= f.date_select(:when, date_select_opts(@observation),
          { class: "form-control mb-2" }) %>
      <% turn_into_year_auto_completer(:observation_when_1i) %>
    </div>
  </div><!--.container-text-->
  <!-- /WHEN -->

  <%= render(partial: "observations/form/where", locals: { f: f }) %>

  <%= naming_locals = {
        action:       action,
        button_name:  button_name,
        show_reasons: false,
        unfocused:    true
      }
  render(partial: "naming/form", locals: naming_locals) if include_naming %>

  <%= render(partial: "observations/form/specimen_info", locals: { f: f }) %>
  <%= render(partial: "observations/form/notes", locals: { f: f }) %>

  <% ########################### Image Forms ############################## %>

  <% if include_images %>

    <%= render(partial: "observations/form/images", locals: { f: f }) %>
    <%= render(partial: "observations/form/images_upload", locals: { f: f }) %>

  <% end # if include_images %>

  <% ##########################################################################     %>

  <% if @projects.any? || @lists.any? %>
    <%= f.submit(button_name, class: "btn btn-default center-block mt-3") %>
  <% end %>

  <% if @projects.any? %>
    <%= render(partial: "observations/form/projects", locals: { f: f }) %>
  <% end %>

  <% if @lists.any? %>
    <%= render(partial: "observations/form/species_lists", locals: { f: f }) %>
  <% end %>

  <%= f.submit(button_name, class: "btn btn-default center-block mt-3") %>

  <% if logging_optional %>
    <div class="form-inline">
      <%= check_box(:log_change, :checked, checked: "1",
                    class: "form-control-xxx") %>
      <%= label_tag(:log_change_checked, :form_observations_log_change.t) %>
    </div>
  <% end %>

<% end %><!--[/form:observation]-->
