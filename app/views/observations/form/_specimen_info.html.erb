<%
# Specimen section of create_observation form,
# for collection_number and herbarium_record.
# Fields hidden unless box checked.
%>

<div class="mt-3 row">
  <div class="col-xs-12 col-sm-6">
    <div class="form-inline">
      <%= f.check_box(:specimen, class: "form-control-xxx") %>
      <%= f.label(:specimen,
                  :form_observations_specimen_available.t) %>
    </div>
    <div class="well well-sm mt-3 help-block position-relative">
      <div class="arrow-up"></div>
      <%= :form_observations_specimen_available_help.t %>
    </div>

    <!-- no_specimen_info -->
    <% if button_name == :SAVE_EDITS.l %>
      <div class="well well-sm help-block">
        <%= :form_observations_edit_specimens_help.t %>
      </div>
    <% end %><!--.well-->
    <!-- /no_specimen_info -->

  </div><!--.col-->
</div><!--.row-->

<% if button_name == :CREATE.l %>
  <!-- specimen_info -->
  <div id="specimen_info" class="<%= "hidden" if !@observation.specimen %>">
    <div class="row mb-3">
      <div class="col-sm-6">

        <%= fields_for(:collection_number) do |fcn| %>
          <div class="form-group">
            <%= fcn.label(:name, :collection_number_name.t + ":") %>
            <%= fcn.text_field(:name, value: @collectors_name,
                               class: "form-control") %>
          </div>
          <div class="form-group">
            <%= fcn.label(:number, :collection_number_number.t + ":") %>
            <%= fcn.text_field(:number, value: @collectors_number,
                               class: "form-control") %>
          </div>
        <% end %>

      </div>
      <div class="col-sm-6">
        <div class="well well-sm help-block position-relative">
          <div class="arrow-left hidden-xs"></div>
          <%= :form_observations_collection_number_help.t %>
        </div>
      </div>
    </div><!--.row-->

    <div class="row mb-3">
      <div class="col-sm-6">

        <%= fields_for(:herbarium_record) do |fhr| %>
          <div class="form-group">
            <%= fhr.label(:herbarium_name,
                          :herbarium_record_herbarium_name.t + ":") %>
            <%= fhr.text_field(:herbarium_name, value: @herbarium_name,
                              class: "form-control") %>
            <% turn_into_herbarium_auto_completer(
                :herbarium_record_herbarium_name
              ) %>
          </div>
          <div class="form-group">
            <%= fhr.label(:herbarium_id,
                          :herbarium_record_accession_number.t + ":") %>
            <%= fhr.text_field(:herbarium_id, value: @herbarium_id,
                              class: "form-control") %>
          </div>
          <div class="form-group">
            <%= fhr.label(:notes, "#{:herbarium_record_notes.t}:") %>
            <%= fhr.text_field(:notes, value: "", class: "form-control") %>
          </div>
        <% end %>

      </div>
      <div class="col-sm-6">
        <div class="well well-sm help-block position-relative">
          <div class="arrow-left hidden-xs"></div>
          <%= :form_observations_herbarium_record_help.t %>
        </div>
      </div>
    </div><!--.row-->
  </div><!--#specimen_info-->
  <!-- /specimen_info -->

  <% if !@user.try(&:hide_specimen_stuff?) %>
    <% inject_javascript_at_end %(
      jQuery(document).ready(function() {
        specimen_checkbox = jQuery("#observation_specimen");
        hide_show_specimen_fields = function () {
          if (specimen_checkbox.is(":checked"))
            jQuery("#specimen_info").removeClass("hidden").show();
          else
            jQuery("#specimen_info").hide();
        };
        hide_show_specimen_fields();
        specimen_checkbox.change(hide_show_specimen_fields);
        jQuery("#collection_number_number,#herbarium_record_herbarium_id").change(function() {
          if (jQuery(this).val().length > 0)
            specimen_checkbox.prop("checked", true)
        });
      });
    ) %>
  <% end %>
<% end %>
