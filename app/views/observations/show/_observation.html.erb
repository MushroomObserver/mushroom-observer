<div class="panel panel-default name-section"
     id="observation_details">
  <div class="panel-body">

    <p id="observation_when">
      <%= :WHEN.t %>: <span class="font-weight-bold"><%= observation.when.web_date %></span>
    </p>

    <p id="observation_where">
      <%= observation.is_collection_location ?
            :show_observation_collection_location.t :
            :show_observation_seen_at.t %>:
      <span class="font-weight-bold">
        <%= location_link(observation.place_name,
                          observation.location, nil, true) %>
      </span>
    </p>

    <p id="observation_lat_lng">
      <%=
        hidden = "<i>(#{:show_observation_gps_hidden.t})</i>".html_safe
        if observation.lat &&
            (!observation.gps_hidden || observation.can_edit?)
          link_to("#{observation.display_lat_long.t} " \
                  "#{observation.display_alt.t} " \
                  "[#{:click_for_map.t}]".html_safe,
                  map_observation_path(id: observation.id))
        elsif observation.lat
          hidden + " ".html_safe + observation.display_alt.t
        else
          observation.display_alt.t
        end
      %>
      <%=
        if observation.lat && observation.gps_hidden && observation.can_edit?
          hidden
        end
      %>
    </p>

    <p id="observation_who">
      <%= :WHO.t %>: <span class="font-weight-bold"><%= user_link(observation.user) %></span>
    </p>

    <% if @user %>
      <div id="observation_projects">
        <% observation.projects.each do |project| %>
              <p><%= :PROJECT.t %>: <%= link_to_object(project) %></p>
        <% end %>
      </div>
    <% end %>

    <div id="observation_specimen_available">
      <%= observation.specimen ? :show_observation_specimen_available.t :
                                 :show_observation_specimen_not_available.t %>
    </div>

    <% if @user %>
      <div id="observation_collection_numbers">
        <%= render(partial: "observations/collection_numbers",
                    locals: { observation: observation }) %>
      </div>

      <div id="observation_herbarium_records">
        <%= render(partial: "observations/herbarium_records",
                    locals: { observation: observation }) %>
      </div>

      <div id="observation_sequences">
        <%= render(partial: "observations/sequences",
                    locals: { observation: observation }) %>
      </div>
    <% end %>

    <div class="obs-notes" id="observation_notes">
      <%= if observation.notes?
        Textile.clear_textile_cache
        Textile.register_name(*observation.namings.map(&:name))
        Textile.register_name(observation.name)
        content_tag(
          :div, observation.notes_show_formatted.sub(/^\A/, "#{:NOTES.t}:\n").tpl
        )
      end %>
    </div><!--.obs-notes-->

  </div><!--.panel-body-->
</div><!--.panel#observation_details-->

