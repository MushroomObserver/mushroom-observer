<% #bs4
# js needs to prepend observation_namings with fresh namings_table on update
%>

<div id="observation_namings">
  <!--TABLE OF NAMES / REFRESHED BY AJAX -->
  <%= render(partial: "observations/namings/table",
             locals: { obs: obs }) %>
  <!--/TABLE OF NAMES -->
</div><!--#observation_namings-->

<!--NAME AUTOCOMPLETE INSTANCE FOR REUSE IN MODALS-->
<%= render(partial: "shared/form_name_autocomplete") %>

<% # initializes module with translations for js messages
inject_javascript_at_end %(
  VoteByAjaxModule({
    show_namings_lose_changes: '#{j :show_namings_lose_changes.l.gsub("\n", " ")}',
    show_namings_saving: '#{j :show_namings_saving.l}'
  })
) %>
<!--/VOTE POPUPS-->

<!--SUGGESTIONS-->
<%
@query ||= nil
url = naming_suggestions_for_observation_path(id: obs.id,
        names: :xxx, q: get_query_param(@query))

inject_javascript_at_end %(
  SuggestionModule(#{obs.image_ids}, "#{url}", {
    suggestions_processing_images:  "#{j :suggestions_processing_images.t}",
    suggestions_processing_image:   "#{j :suggestions_processing_image.t}",
    suggestions_processing_results: "#{j :suggestions_processing_results.t}",
    suggestions_error:              "#{j :suggestions_error.t}"
  });
) %>
<!--/SUGGESTIONS-->
