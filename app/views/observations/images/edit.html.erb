<%
  @title = :image_edit_title.t(name: @image.unique_format_name)

  tabs = [
    link_with_query(:cancel_and_show.t(type: :image), @image.show_link_args)
  ]
  @tabsets = { right: draw_tab_set(tabs) }
  @container = :wide
  form_action = { controller: "/observations/images",
                  action: :update,
                  id: @image.id,
                  q: get_query_param }
%>

<div class="col-xs-12 col-sm-8 col-md-6 col-lg-4">
  <%= form_with(model: @image, url: form_action, method: :put) do |f| %>

    <%= f.submit(:SAVE_EDITS.l, class: "btn btn-default center-block mt-3") %>

    <%= render(partial: "observations/images/form/fields_for_images",
               locals: { f: f, leave_out_original_file_name: false }) %>

    <% if @projects.any? %>
      <div class="form-group form-inline">
        <%= content_tag(:p, class: "font-weight-bold") { :PROJECTS.t + ":" } %>
        <%= content_tag(:p, class: "help-block") { :form_images_project_help.t } %>
        <div class="text-nowrap">
          <%= render(partial: "observations/images/form/project",
                     collection: @projects) %>
        </div>
      </div>
    <% end %>

    <div class="text-center mt-3 mb-5">
      <%= f.submit(:SAVE_EDITS.l, class: "btn btn-default") %>
      <%= link_with_query(:cancel_and_show.t(type: :image),
                          image_path(@image.id),
                          { class: "btn btn-default" }) %>
    </div>

  <% end %>
</div>

<div class="col-xs-12 col-sm-4 col-md-6 col-lg-8">
  <%= thumbnail(@image, { size: :medium, votes: true, responsive: true }) %>
</div>
