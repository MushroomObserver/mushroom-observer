<% #bs4
  comments = object.comments.includes(:user).sort_by(&:created_at).reverse
  if limit
    and_more = comments.length - limit
    comments = comments[0..limit-1]
  end
%>

<%=
tag.turbo_frame(
  class: "panel panel-default", id: "comments_for_object",
  data: { controller: "section-update", updated_by: "modal_comment" }
) do
  [
    tag.div(class: "panel-heading") do
      tag.h4(:COMMENTS.t, class: "panel-title")
    end,
    tag.div(class: "list-group list-group-flush comments") do
      if comments.empty?
        tag.div(:show_comments_no_comments_yet.t, class: "list-group-item")
      else
        comments.each do |comment|
          concat(render(partial: "comments/comment", object: comment))
        end
      end
    end,
    tag.div(class: "panel-footer") do
      concat(
        modal_link_to("comment", :show_comments_add_comment.t,
                      new_comment_path(q: get_query_param, target: object.id,
                                       type: object.class.name),
                      class: "btn btn-default btn-sm new_comment_link")
      ) if controls
      concat(
        link_to(:show_comments_and_more.t(num: and_more),
                comments_path(target: object.id, type: object.class.name),
                class: "float-right")
      ) if limit && and_more > 0
    end
  ].safe_join
end %>
