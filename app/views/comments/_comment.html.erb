<%
  target = comment.target
  user = comment.user
%>

<div class="list-group comment" id="comment_<%= comment.id %>">
  <div class="list-group-item default">

    <% if user.image_id %>
      <div class="hidden-xs float-right text-center"
           style="width:25%; max-width:160px; max-height:160px">
        <%= image_tag(Image.url(:thumbnail, user.image_id),
                      style: "max-width:100%; max-height:100%",
                      data: { role: "link", url: user_path(user.id) }) %>
      </div>
    <% end %>

    <% if local_assigns[:show_name] && show_name %>
      <h4 class="mt-0">
        <%= link_to(target.unique_format_name.t, target.show_link_args) \
                    rescue :comment_list_deleted.t %>
        <small>(<%= target.class.name.to_sym.t rescue :runtime_object_deleted %>)</small>
      </h4>
    <% end %>

    <div class="font-weight-bold">
      <%= comment.summary.tl %>
    </div>

    <div class="container-text">
      <%= :BY.t %>: <%= user_link(user) %>
      <% if check_permission(comment) %>
        <span class="text-nowrap">
          [<%= link_with_query(:EDIT.t, edit_comment_path(comment.id),
                               class: "edit_comment_link_#{comment.id}",
                               remote: true) %> |
          <%= destroy_button(name: :comment_show_destroy.t, target: comment,
                             remote: true) %>]
        </span>
      <% end %>
      <div class="pull-right text-nowrap small my-0 mx-3">
        <%= comment.created_at.web_time %>
      </div>
    </div><!--.container-text-->

    <% unless comment.comment.blank? %>
      <div class="p-5px container-text">
        <%= comment.comment.tpl %>
      </div><!--.container-text-->
    <% end %>

    <% if user.image_id %>
      <div style="clear:right"></div>
    <% end %>
  </div>
</div>
