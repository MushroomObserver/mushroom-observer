<%
add_page_title(:show_project_title.t(title: @project.title))
add_pager_for(@project)
add_interest_icons(@user, @project)
add_tab_set(project_show_tabs(project: @project, user: @user))
%>

<% if @project.can_join?(@user) %>
  <%= post_button(name: :show_project_join.t,
      path: project_members_path(project_id: @project.id,
                                 candidate: @user.id)) %>
<% elsif @project.can_leave?(@user) %>
  <%= put_button(name: :show_project_leave.t,
                 path: project_member_path(project_id: @project.id,
                                           candidate: @user.id)) %>
<% end %>

<%= panel_block do %>
  <%= ("*" + :show_project_summary.l + ":* " + @project.summary.to_s.html_safe).tpl %>
  <p><b><%= link_to(:Members.t + ": #{@project.user_group.users.count}",
                    project_members_path(project_id: @project.id)) %></b></p>

  <% if @project.location %>
    <p><b><%= link_to("#{:show_project_location.t}: #{@project.place_name}",
	              location_path(@project.location.id)) %></b></p>
  <% end %>

  <% if @project.observations.any? %>
    <p><b><%= link_to("#{:OBSERVATIONS.t}: #{@project.observations.length}",
                      observations_path(project: @project.id)) %></b></p>
    <p><b><%= link_to("#{:NAMES.t}: #{@project.name_count}",
                      checklist_path(project_id: @project.id)) %></b></p>
  <% end %>

  <% if @project.images.any? %>
    <p><b><%= :IMAGES.t %>:</b>
    <%= @project.images.length %>
    (<%= link_to(:SHOW.t, images_path(for_project: @project.id)) %>)
    </p>
  <% end %>

  <% if @project.species_lists.any? %>
    <p><b><%= :SPECIES_LISTS.t %>:</b>
    <%= @project.species_lists.length %>
    (<%= link_to(:SHOW.t,
                  species_lists_path(for_project: @project.id)) %>)
    </p>
  <% end %>

  <% if @drafts.any? %>
    <p><b><%= :show_project_drafts.t %>:</b>
    <%= @drafts.length %><br/>
    <div class="ml-3">
      <% @drafts.each do |draft| %>
        <%= link_with_query(draft.name&.display_name&.t,
                            name_description_path(draft.id)) %>
        (<%= user_link(draft.user) %>)<br/>
      <% end %>
    </div>
    </p>
  <% end %>

  <p><b><%= :show_project_created_at.t %>:</b> <%= @project.created_at.web_date %></p>

<% end %>

<%= render(partial: "comments/comments_for_object",
           locals: { object: @project, controls: true, limit: nil }) %>

<%= show_object_footer(@project) %>
